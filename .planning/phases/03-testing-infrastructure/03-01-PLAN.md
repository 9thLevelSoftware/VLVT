---
phase: 03-testing-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/auth-service/package.json
  - backend/profile-service/package.json
  - backend/chat-service/package.json
autonomous: true

must_haves:
  truths:
    - "npm test runs without Jest config conflict errors in all three services"
    - "Existing tests execute (pass or fail based on implementation, but no config errors)"
  artifacts:
    - path: "backend/auth-service/package.json"
      provides: "Jest runs via jest.config.js only"
      contains: "\"test\": \"jest\""
    - path: "backend/profile-service/package.json"
      provides: "Jest runs via jest.config.js only"
      contains: "\"test\": \"jest\""
    - path: "backend/chat-service/package.json"
      provides: "Jest runs via jest.config.js only"
      contains: "\"test\": \"jest\""
  key_links:
    - from: "package.json scripts.test"
      to: "jest.config.js"
      via: "Jest auto-discovery"
      pattern: "jest.config.js"
---

<objective>
Fix Jest configuration conflict blocking all backend tests

Purpose: Research identified that all three backend services have BOTH a `jest.config.js` file AND a `jest` key in `package.json`. Jest refuses to run with this ambiguity. This is a BLOCKING issue preventing any test execution.

Output: All three services have clean Jest configuration with only `jest.config.js` as the authoritative source.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-testing-infrastructure/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove jest key from auth-service package.json</name>
  <files>backend/auth-service/package.json</files>
  <action>
Delete the entire `jest` key (lines 61-77 approximately) from package.json.

The `jest.config.js` file already exists and has correct configuration including:
- preset: 'ts-jest'
- testEnvironment: 'node'
- roots: ['<rootDir>/src', '<rootDir>/tests']
- setupFilesAfterEnv: ['<rootDir>/tests/setup.ts']
- coverageThreshold at 30% (more realistic than package.json's 50%)

Keep all other fields (name, version, scripts, dependencies, devDependencies) intact.

Do NOT modify jest.config.js - it's already correct.
  </action>
  <verify>
Run: `cd backend/auth-service && npm test -- --listTests`
Should list test files without "Multiple configurations found" error.
  </verify>
  <done>Jest command executes without config conflict error in auth-service</done>
</task>

<task type="auto">
  <name>Task 2: Remove jest key from profile-service package.json</name>
  <files>backend/profile-service/package.json</files>
  <action>
Delete the entire `jest` key (lines 64-80 approximately) from package.json.

The `jest.config.js` file already exists with matching correct configuration.

Keep all other fields intact.
  </action>
  <verify>
Run: `cd backend/profile-service && npm test -- --listTests`
Should list test files without config conflict error.
  </verify>
  <done>Jest command executes without config conflict error in profile-service</done>
</task>

<task type="auto">
  <name>Task 3: Remove jest key from chat-service package.json</name>
  <files>backend/chat-service/package.json</files>
  <action>
Delete the entire `jest` key (lines 57-73 approximately) from package.json.

The `jest.config.js` file already exists with matching correct configuration.

Keep all other fields intact.
  </action>
  <verify>
Run: `cd backend/chat-service && npm test -- --listTests`
Should list test files without config conflict error.
  </verify>
  <done>Jest command executes without config conflict error in chat-service</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Verify config conflict resolved in all services:
```bash
cd backend/auth-service && npm test -- --listTests 2>&1 | head -20
cd backend/profile-service && npm test -- --listTests 2>&1 | head -20
cd backend/chat-service && npm test -- --listTests 2>&1 | head -20
```

2. Run actual tests to confirm they execute (some may fail - that's expected):
```bash
cd backend/auth-service && npm test -- --passWithNoTests 2>&1 | tail -20
```

Success: No "Multiple configurations found" errors. Tests list or run (pass/fail is secondary).
</verification>

<success_criteria>
- [ ] auth-service/package.json has no `jest` key
- [ ] profile-service/package.json has no `jest` key
- [ ] chat-service/package.json has no `jest` key
- [ ] `npm test -- --listTests` works in all three services
- [ ] No "Multiple configurations found" error from Jest
</success_criteria>

<output>
After completion, create `.planning/phases/03-testing-infrastructure/03-01-SUMMARY.md`
</output>
