---
phase: 04-bug-fixes-ui-polish
plan: 04
type: execute
wave: 3
depends_on: ["04-02", "04-03"]
files_modified:
  - frontend/lib/screens/*.dart
  - frontend/lib/widgets/*.dart
autonomous: false

must_haves:
  truths:
    - "All navigation paths work bidirectionally"
    - "No tappable elements do nothing"
    - "No screens are dead ends"
    - "Back navigation works on all screens"
  artifacts:
    - path: "frontend/lib/screens/main_screen.dart"
      provides: "Main navigation hub"
      contains: "Navigator"
  key_links:
    - from: "screens/*.dart"
      to: "Navigator"
      via: "push/pop/pushReplacement"
      pattern: "Navigator\\."
---

<objective>
Fix navigation issues and verify UX flows end-to-end

Purpose: Users can navigate smoothly through the app with no dead ends or broken paths
Output: All navigation paths tested and fixed, human verification of complete flows
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-bug-fixes-ui-polish/04-CONTEXT.md
@.planning/phases/04-bug-fixes-ui-polish/04-AUDIT.md
@.planning/phases/04-bug-fixes-ui-polish/04-01-SUMMARY.md
@.planning/phases/04-bug-fixes-ui-polish/04-02-SUMMARY.md
@.planning/phases/04-bug-fixes-ui-polish/04-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Navigation Issues from Audit</name>
  <files>from 04-AUDIT.md navigation issues</files>
  <action>
Based on 04-AUDIT.md findings, fix all navigation issues:

1. **Dead end screens**: Ensure every screen has either:
   - A back button in the AppBar
   - A clear navigation action to continue
   - For modals: A close/dismiss option

2. **Broken navigation handlers**: Fix any tappable elements that:
   - Have null onPressed/onTap
   - Call non-existent routes
   - Navigate to placeholder screens

3. **Missing back navigation**: Add AppBar with back button where missing:
```dart
AppBar(
  backgroundColor: VlvtColors.background,
  leading: IconButton(
    icon: const Icon(Icons.arrow_back, color: VlvtColors.textPrimary),
    onPressed: () => Navigator.pop(context),
  ),
  // ...
)
```

4. **PopScope handling**: Verify screens that prevent back:
   - Profile setup (should prevent accidental exit)
   - Payment flows (should warn before exit)
   - Should NOT block back on regular screens

5. **Deep link handling**: Ensure screens that can be deep-linked handle missing data gracefully
  </action>
  <verify>
`flutter analyze` passes
  </verify>
  <done>All navigation issues from audit fixed</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete UI polish: loading states, error states, empty states, design system consistency, and navigation fixes applied to all 29 screens.
  </what-built>
  <how-to-verify>
Test the following core flows in the running app:

**1. Auth Flow (5 min)**
- Launch app, verify splash screen looks polished
- Navigate to login screen
- Test "Forgot Password" link works
- Test "Register" link works
- Attempt login with invalid credentials -> verify friendly error message
- Login with valid credentials -> verify smooth transition

**2. Onboarding Flow (5 min)**
- After first login, verify profile setup screen appears
- Complete profile setup
- Verify navigation to main screen

**3. Discovery Flow (5 min)**
- Verify discovery screen loads with VlvtLoader
- If no profiles: verify empty state with helpful message
- Test swipe interactions work
- Test filter button navigation
- Verify match overlay when matching

**4. Matches & Chat Flow (5 min)**
- Navigate to matches tab
- If no matches: verify empty state
- If matches exist: tap a match
- Verify chat screen loads properly
- Test sending a message
- Test back navigation

**5. Profile Flow (5 min)**
- Navigate to profile tab
- Verify profile displays correctly
- Test edit profile navigation
- Test settings navigation
- Verify all settings options navigate properly

**6. After Hours Flow (5 min)**
- Navigate to After Hours tab
- Verify consent flow if first time
- Verify session UI displays correctly

Look for:
- No blank screens during loading
- No technical error messages
- No empty lists without guidance
- Consistent colors and typography
- All buttons and links work
- Back navigation always works
  </how-to-verify>
  <resume-signal>Type "approved" if all flows work correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
- [ ] No navigation dead ends
- [ ] All tappable elements have working handlers
- [ ] Back navigation works on all screens
- [ ] Human verified core flows work end-to-end
- [ ] No visual inconsistencies in running app
</verification>

<success_criteria>
Users can navigate through all app flows without:
1. Getting stuck on any screen
2. Tapping buttons that do nothing
3. Seeing inconsistent UI elements
4. Encountering broken transitions
</success_criteria>

<output>
After completion, create `.planning/phases/04-bug-fixes-ui-polish/04-04-SUMMARY.md`
</output>
