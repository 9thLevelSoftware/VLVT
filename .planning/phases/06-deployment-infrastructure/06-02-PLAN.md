---
phase: 06-deployment-infrastructure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/auth-service/.env.example
  - docs/ENVIRONMENT_VARIABLES.md
autonomous: false

must_haves:
  truths:
    - "Email service environment variables are documented in .env.example"
    - "Resend API key is configured in Railway (verified by user)"
    - "Email verification and password reset emails can be sent"
  artifacts:
    - path: "backend/auth-service/.env.example"
      provides: "Email configuration variables template"
      contains: "EMAIL_PROVIDER"
  key_links:
    - from: "backend/auth-service/src/services/email-service.ts"
      to: "process.env.RESEND_API_KEY"
      via: "Configuration loading"
      pattern: "RESEND_API_KEY"

user_setup:
  - service: resend
    why: "Transactional email delivery for verification and password reset"
    env_vars:
      - name: EMAIL_PROVIDER
        value: "resend"
        source: "Static value"
      - name: RESEND_API_KEY
        source: "Resend Dashboard -> API Keys -> Create API Key"
      - name: EMAIL_FROM
        value: "noreply@getvlvt.vip"
        source: "Must match verified domain in Resend"
    dashboard_config:
      - task: "Add and verify sending domain"
        location: "Resend Dashboard -> Domains -> Add Domain"
      - task: "Create API key"
        location: "Resend Dashboard -> API Keys"
---

<objective>
Configure email service for production by documenting required environment variables and verifying Resend configuration.

Purpose: DEP-05 requires email service for verification and password reset emails. The email-service.ts already exists with Resend support - this plan documents the configuration and creates a checkpoint for user to configure Resend.

Output: Updated .env.example with email configuration, user-verified Resend setup
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-deployment-infrastructure/06-RESEARCH.md
@backend/auth-service/.env.example
@backend/auth-service/src/services/email-service.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document Email Configuration in .env.example</name>
  <files>backend/auth-service/.env.example</files>
  <action>
Add email service configuration section to auth-service .env.example:

```
# =============================================================================
# Email Service Configuration (REQUIRED for email verification and password reset)
# =============================================================================
# Supported providers: console (dev only), smtp, sendgrid, resend
# For production, use 'resend' (recommended) or 'sendgrid'
EMAIL_PROVIDER=console

# Resend Configuration (if EMAIL_PROVIDER=resend)
# Get from: Resend Dashboard -> API Keys -> Create API Key
# RESEND_API_KEY=re_xxxxxxxxx

# SendGrid Configuration (if EMAIL_PROVIDER=sendgrid)
# Get from: SendGrid Dashboard -> Settings -> API Keys
# SENDGRID_API_KEY=SG.xxxxxxxxx

# SMTP Configuration (if EMAIL_PROVIDER=smtp)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=your-smtp-user
# SMTP_PASS=your-smtp-password

# Email sender configuration
# EMAIL_FROM must match a verified domain in your email provider
EMAIL_FROM=noreply@getvlvt.vip
APP_NAME=VLVT
APP_URL=https://getvlvt.vip
```

Place after the Monitoring section (at end of file).
  </action>
  <verify>
- grep "EMAIL_PROVIDER" backend/auth-service/.env.example returns result
- grep "RESEND_API_KEY" backend/auth-service/.env.example returns result
- Comments explain where to get credentials
  </verify>
  <done>Email configuration variables documented in .env.example with clear instructions</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Email service environment variables documented. The email-service.ts already supports Resend - it needs configuration in Railway.</what-built>
  <how-to-verify>
1. **Create Resend account** (if not already): https://resend.com/signup
2. **Add sending domain**:
   - Go to Resend Dashboard -> Domains -> Add Domain
   - Add: getvlvt.vip (or your production domain)
   - Add DNS records as instructed by Resend
   - Wait for domain verification (may take a few minutes)
3. **Create API key**:
   - Go to Resend Dashboard -> API Keys -> Create API Key
   - Name it "VLVT Production"
   - Copy the key (starts with re_)
4. **Configure Railway**:
   - Go to Railway -> auth-service -> Variables
   - Add: EMAIL_PROVIDER=resend
   - Add: RESEND_API_KEY=re_your_key_here
   - Add: EMAIL_FROM=noreply@getvlvt.vip
   - Add: APP_NAME=VLVT
   - Add: APP_URL=https://getvlvt.vip
5. **Test** (optional, after deploy):
   - Try password reset flow in app
   - Check Resend Dashboard -> Emails for delivery logs
  </how-to-verify>
  <resume-signal>Type "email configured" when Resend is set up in Railway, or "skip" to configure later</resume-signal>
</task>

</tasks>

<verification>
- [ ] .env.example includes EMAIL_PROVIDER and related variables
- [ ] User has configured Resend in Railway (or explicitly skipped)
</verification>

<success_criteria>
DEP-05: Email service environment variables documented and production configuration verified
</success_criteria>

<output>
After completion, create `.planning/phases/06-deployment-infrastructure/06-02-SUMMARY.md`
</output>
