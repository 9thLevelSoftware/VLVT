---
phase: 10-page-transitions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/lib/utils/vlvt_routes.dart
  - frontend/lib/main.dart
  - frontend/lib/services/deep_link_service.dart
  - frontend/lib/screens/auth_screen.dart
  - frontend/lib/screens/register_screen.dart
  - frontend/lib/screens/paywall_screen.dart
  - frontend/lib/screens/search_screen.dart
autonomous: true
requirements:
  - UX-01
  - UX-02
  - UX-03
must_haves:
  truths:
    - "VlvtPageRoute provides a slide-from-right transition with easeOutCubic curve"
    - "VlvtFadeRoute provides a crossfade transition for modal/overlay screens"
    - "All navigation calls in main.dart, deep_link_service.dart, auth_screen.dart, register_screen.dart, paywall_screen.dart, and search_screen.dart use VlvtPageRoute or VlvtFadeRoute instead of MaterialPageRoute"
  artifacts:
    - path: "frontend/lib/utils/vlvt_routes.dart"
      provides: "VlvtPageRoute<T> and VlvtFadeRoute<T> route classes"
      exports: ["VlvtPageRoute", "VlvtFadeRoute"]
    - path: "frontend/lib/main.dart"
      provides: "Updated navigation calls using VlvtPageRoute"
    - path: "frontend/lib/services/deep_link_service.dart"
      provides: "Updated navigation calls using VlvtPageRoute"
    - path: "frontend/lib/screens/auth_screen.dart"
      provides: "Updated navigation calls using VlvtPageRoute and VlvtFadeRoute"
  key_links:
    - from: "frontend/lib/utils/vlvt_routes.dart"
      to: "all screen files"
      via: "import and instantiation"
      pattern: "import.*vlvt_routes"
---

<objective>
Create the shared VlvtPageRoute and VlvtFadeRoute transition classes and replace all MaterialPageRoute calls in entry-point and service files (main.dart, deep_link_service.dart, auth_screen.dart, register_screen.dart, paywall_screen.dart, search_screen.dart).

Purpose: Establish the two reusable route classes that the entire app will use, and migrate the first batch of 12 navigation calls covering app entry, deep links, auth flow, paywall, and search.

Output: `vlvt_routes.dart` with both route classes; 6 files updated to use them.
</objective>

<execution_context>
@C:/Users/dasbl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/dasbl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-page-transitions/10-RESEARCH.md

@frontend/lib/utils/hero_tags.dart
@frontend/lib/main.dart
@frontend/lib/services/deep_link_service.dart
@frontend/lib/screens/auth_screen.dart
@frontend/lib/screens/register_screen.dart
@frontend/lib/screens/paywall_screen.dart
@frontend/lib/screens/search_screen.dart

<interfaces>
<!-- No existing interfaces to consume. This plan CREATES the route classes. -->
<!-- Pattern from existing codebase (hero_tags.dart lives in lib/utils/): -->
<!-- import 'package:vlvt/utils/hero_tags.dart'; -->
<!-- New import will be: import 'package:vlvt/utils/vlvt_routes.dart'; -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VlvtPageRoute and VlvtFadeRoute classes</name>
  <files>frontend/lib/utils/vlvt_routes.dart</files>
  <action>
Create `frontend/lib/utils/vlvt_routes.dart` with two classes:

**VlvtPageRoute<T>** — Slide-from-right transition for forward navigation:
```dart
import 'package:flutter/material.dart';

/// Slide-from-right page transition for forward navigation.
/// Uses easeOutCubic curve to match the app's design language.
class VlvtPageRoute<T> extends PageRouteBuilder<T> {
  VlvtPageRoute({
    required Widget Function(BuildContext) builder,
    super.settings,
    super.fullscreenDialog,
    super.maintainState = true,
  }) : super(
          pageBuilder: (context, animation, secondaryAnimation) =>
              builder(context),
          transitionsBuilder: (context, animation, secondaryAnimation, child) {
            return SlideTransition(
              position: Tween<Offset>(
                begin: const Offset(1.0, 0.0),
                end: Offset.zero,
              ).animate(CurvedAnimation(
                parent: animation,
                curve: Curves.easeOutCubic,
              )),
              child: child,
            );
          },
        );
}
```

**VlvtFadeRoute<T>** — Crossfade transition for modal/overlay screens:
```dart
/// Crossfade transition for modal and overlay screens
/// (paywall, legal documents, filters, after-hours overlays).
class VlvtFadeRoute<T> extends PageRouteBuilder<T> {
  VlvtFadeRoute({
    required Widget Function(BuildContext) builder,
    super.settings,
    super.fullscreenDialog,
    super.maintainState = true,
  }) : super(
          pageBuilder: (context, animation, secondaryAnimation) =>
              builder(context),
          transitionsBuilder: (context, animation, secondaryAnimation, child) {
            return FadeTransition(opacity: animation, child: child);
          },
        );
}
```

IMPORTANT:
- Both classes MUST be generic (`<T>`) to preserve Navigator return types (e.g., `Navigator.push<bool>`).
- Do NOT set `opaque: false` — this would break Hero animations.
- Keep default 300ms duration (matches MaterialPageRoute, no test timing changes).
- Pass through `settings` and `fullscreenDialog` super parameters for compatibility with pushAndRemoveUntil and other Navigator methods.
  </action>
  <verify>
    <automated>cd "C:/Users/dasbl/AndroidStudioProjects/VLVT/frontend" && flutter analyze lib/utils/vlvt_routes.dart 2>&1 | tail -5</automated>
  </verify>
  <done>
`vlvt_routes.dart` exists in `lib/utils/`, exports VlvtPageRoute and VlvtFadeRoute, and passes flutter analyze with no errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace MaterialPageRoute in entry-point and service files</name>
  <files>
frontend/lib/main.dart
frontend/lib/services/deep_link_service.dart
frontend/lib/screens/auth_screen.dart
frontend/lib/screens/register_screen.dart
frontend/lib/screens/paywall_screen.dart
frontend/lib/screens/search_screen.dart
  </files>
  <action>
Add `import 'package:vlvt/utils/vlvt_routes.dart';` to each file listed below. Then replace every `MaterialPageRoute` call with the appropriate route class.

**main.dart (2 calls):**
1. Line ~107: `MaterialPageRoute(builder: (context) => ChatScreen(...))` → `VlvtPageRoute(builder: (_) => ChatScreen(...))`
2. Line ~125: `MaterialPageRoute(builder: (context) => MainScreen(...))` inside `pushAndRemoveUntil` → `VlvtPageRoute(builder: (_) => MainScreen(...))`

**deep_link_service.dart (3 calls):**
3. Line ~102: `MaterialPageRoute(builder: (context) => ResetPasswordScreen(...))` → `VlvtPageRoute(builder: (_) => ResetPasswordScreen(...))`
4. Line ~127: `MaterialPageRoute(builder: (context) => MainScreen(...))` → `VlvtPageRoute(builder: (_) => MainScreen(...))`
5. Line ~149: `MaterialPageRoute(builder: (context) => ChatScreen(...))` → `VlvtPageRoute(builder: (_) => ChatScreen(...))`

**auth_screen.dart (5 calls):**
6. Line ~67: `MaterialPageRoute(builder: (context) => VerificationPendingScreen(...))` → `VlvtPageRoute(builder: (_) => VerificationPendingScreen(...))`
7. Line ~373: `MaterialPageRoute(builder: (context) => ForgotPasswordScreen())` → `VlvtPageRoute(builder: (_) => const ForgotPasswordScreen())`
8. Line ~388: `MaterialPageRoute(builder: (context) => RegisterScreen())` → `VlvtPageRoute(builder: (_) => const RegisterScreen())`
9. Line ~491: `MaterialPageRoute(builder: (context) => LegalDocumentViewer(...))` (Terms of Service) → `VlvtFadeRoute(builder: (_) => LegalDocumentViewer(...))` — this is a legal/modal document
10. Line ~529: `MaterialPageRoute(builder: (context) => LegalDocumentViewer(...))` (Privacy Policy) → `VlvtFadeRoute(builder: (_) => LegalDocumentViewer(...))` — this is a legal/modal document

**register_screen.dart (1 call):**
11. Line ~143: `MaterialPageRoute(builder: (context) => VerificationPendingScreen(...))` inside `pushReplacement` → `VlvtPageRoute(builder: (_) => VerificationPendingScreen(...))`

**paywall_screen.dart (1 call):**
12. Line ~28: `MaterialPageRoute(builder: (context) => PaywallScreen(...))` → `VlvtFadeRoute(builder: (_) => PaywallScreen(...))` — paywall is a modal/overlay

**search_screen.dart (1 call):**
13. Line ~138: `MaterialPageRoute(builder: (context) => SearchResultsScreen(...))` → `VlvtPageRoute(builder: (_) => SearchResultsScreen(...))`

IMPORTANT:
- Preserve the exact Navigator method (push, pushReplacement, pushAndRemoveUntil) — only the Route object changes.
- Preserve generic type parameters: if the original was `Navigator.push<bool>(context, MaterialPageRoute<bool>(...))`, use `VlvtPageRoute<bool>(...)`.
- Preserve all constructor arguments passed to destination screens.
- Remove the unused `import 'package:flutter/material.dart'` ONLY if no other Material imports remain in the file. In practice, every screen file uses Material widgets, so the import stays.
- Remove the `context` parameter name in the builder callback — use `_` since it's unused in route construction (consistent with codebase pattern).
  </action>
  <verify>
    <automated>cd "C:/Users/dasbl/AndroidStudioProjects/VLVT/frontend" && flutter analyze lib/main.dart lib/services/deep_link_service.dart lib/screens/auth_screen.dart lib/screens/register_screen.dart lib/screens/paywall_screen.dart lib/screens/search_screen.dart 2>&1 | tail -10</automated>
  </verify>
  <done>
All 13 MaterialPageRoute calls across the 6 files are replaced. `flutter analyze` passes with no errors on all modified files. Running `grep -rn "MaterialPageRoute" frontend/lib/main.dart frontend/lib/services/deep_link_service.dart frontend/lib/screens/auth_screen.dart frontend/lib/screens/register_screen.dart frontend/lib/screens/paywall_screen.dart frontend/lib/screens/search_screen.dart` returns zero results.
  </done>
</task>

</tasks>

<verification>
1. `flutter analyze` passes on all 7 files (vlvt_routes.dart + 6 modified files)
2. `grep -rn "MaterialPageRoute" frontend/lib/main.dart frontend/lib/services/ frontend/lib/screens/auth_screen.dart frontend/lib/screens/register_screen.dart frontend/lib/screens/paywall_screen.dart frontend/lib/screens/search_screen.dart` returns zero results
3. `flutter test` passes — no regressions from route changes (duration unchanged at 300ms)
</verification>

<success_criteria>
- VlvtPageRoute and VlvtFadeRoute classes exist in lib/utils/vlvt_routes.dart
- 13 MaterialPageRoute calls replaced across 6 files
- Zero flutter analyze errors
- All existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/10-page-transitions/10-01-SUMMARY.md`
</output>
